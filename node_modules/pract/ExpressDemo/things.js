var express = require('express');
var router = express.Router();
var bodyParser = require('body-parser');
var con = require('./db.js');

// Create application/x-www-form-urlencoded parser
var urlencodedParser = bodyParser.urlencoded({ extended: false })

router.get('/', function (req, res) {
    res.render('add-things', { heading: "Add things" });
});

router.post('/', urlencodedParser, function (req, res) {
    var sql = 'INSERT INTO user (`firstname`, `email`, `mobile`) VALUES ("' + req.body.firstName + '", "' + req.body.email + '", "' + req.body.mobile + '") ';
    console.log(sql);
    con.query(sql,
        function (err, result) {
            if (err) throw err;
            res.writeHead(302,
              { Location: '/dynamic' }
            );
            res.end();
        }
    );
});

//router.get('/:cid([0-9]{5})', function (req, res) {
//    res.send('GET route on things. Parameter is cid = ' + req.params.cid);
//});

//router.get('/:id', function (req, res) {
//    res.send('GET route on things. Parameter is ' + req.params.id);
//});
//router.get('/:name', function (req, res) {
//    res.send('GET route on things. Parameter is ' + req.params.name);
//});
//router.get('/:id/:name', function (req, res) {
//    res.send('GET route on things. Parameter is id = ' + req.params.id + " and name = " + req.params.name);
//});

//export this router to use in our index.js
module.exports = router;