var express = require('express')
var router = express.Router();
var bodyParser = require('body-parser');
var con = require('./db.js');
var app = express();

app.set('view engine', 'ejs');
app.set('views', './public/views');


// Create application/x-www-form-urlencoded parser
var urlencodedParser = bodyParser.urlencoded({ extended: false })

router.get('/', function (req, res) {
    res.render('insert', { heading: "Add things" });
});

router.post('/', urlencodedParser, function (req, res) {
    var sql = 'INSERT INTO student (`fname`,`lname`, `email`, `password`) VALUES ("' + req.body.fname + '", "' + req.body.lname + '","' + req.body.email + '", "' + req.body.pass + '") ';
    console.log(sql);
    con.query(sql,
        function (err, result) {
            if (err) throw err;
            res.writeHead(302,
              { Location: '/select' }
            );
            res.end();
        }
    );
});

module.exports = router;